{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport * as React from \"react\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport { useSelector } from \"react-redux\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport axios from \"axios\";\nimport { useDispatch } from \"react-redux\";\nimport { setSignIn } from \"../redux/slices/authSlice\";\nimport { AppNavigator } from \"./app-navigator\";\nimport AuthNavigator from \"./auth-navigator\";\nimport BottomTabNavigator from \"./TabNavigator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar AppRoute = function AppRoute() {\n  var dispatch = useDispatch();\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isLoggedIn = _React$useState2[0],\n      setIsLoggedIn = _React$useState2[1];\n\n  var authInfo = useSelector(function (state) {\n    return state.userAuth;\n  });\n\n  var getUserInfo = function _callee2() {\n    var value;\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"token\"));\n\n          case 3:\n            value = _context2.sent;\n\n            if (!(value !== null)) {\n              _context2.next = 9;\n              break;\n            }\n\n            _context2.next = 7;\n            return _regeneratorRuntime.awrap(axios.get(\"/profile\").then(function _callee(response) {\n              return _regeneratorRuntime.async(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      dispatch(setSignIn(response.data));\n                      setIsLoggedIn(true);\n\n                    case 2:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }).catch(function (error) {\n              console.log(error);\n              setIsLoggedIn(false);\n            }));\n\n          case 7:\n            _context2.next = 10;\n            break;\n\n          case 9:\n            setIsLoggedIn(false);\n\n          case 10:\n            _context2.next = 15;\n            break;\n\n          case 12:\n            _context2.prev = 12;\n            _context2.t0 = _context2[\"catch\"](0);\n            setIsLoggedIn(false);\n\n          case 15:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 12]], Promise);\n  };\n\n  var checkAuthentication = function checkAuthentication() {\n    if (authInfo.userInfo) {\n      setIsLoggedIn(authInfo.isLoggedIn);\n    } else {\n      getUserInfo();\n    }\n  };\n\n  React.useEffect(function () {\n    if (authInfo.token && authInfo.token != '') {\n      setIsLoggedIn(true);\n    }\n  }, [authInfo.token]);\n  return _jsx(NavigationContainer, {\n    children: isLoggedIn ? _jsx(BottomTabNavigator, {}) : _jsx(AuthNavigator, {})\n  });\n};\n\nexport default AppRoute;","map":{"version":3,"names":["React","NavigationContainer","useSelector","AsyncStorage","axios","useDispatch","setSignIn","AppNavigator","AuthNavigator","BottomTabNavigator","AppRoute","dispatch","useState","isLoggedIn","setIsLoggedIn","authInfo","state","userAuth","getUserInfo","getItem","value","get","then","response","data","catch","error","console","log","checkAuthentication","userInfo","useEffect","token"],"sources":["D:/react-native/bdrentz/src/route/index.js"],"sourcesContent":["import * as React from \"react\";\r\nimport { NavigationContainer } from \"@react-navigation/native\";\r\nimport { useSelector } from \"react-redux\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport axios from \"axios\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { setSignIn } from \"../redux/slices/authSlice\";\r\n\r\nimport {AppNavigator} from \"./app-navigator\";\r\nimport AuthNavigator from \"./auth-navigator\";\r\nimport BottomTabNavigator from \"./TabNavigator\";\r\n\r\nconst AppRoute = () => {\r\n  const dispatch = useDispatch();\r\n  const [isLoggedIn, setIsLoggedIn] = React.useState(false);\r\n  const authInfo = useSelector((state) => state.userAuth);\r\n\r\n  const getUserInfo = async () => {\r\n    try {\r\n      //get token from local storage\r\n      const value = await AsyncStorage.getItem(\"token\");\r\n\r\n      if (value !== null) {\r\n        //get profile info from api\r\n        await axios\r\n          .get(\"/profile\")\r\n          .then(async (response) => {\r\n            dispatch(setSignIn(response.data));\r\n            setIsLoggedIn(true);\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n            setIsLoggedIn(false);\r\n          });\r\n      } else {\r\n        setIsLoggedIn(false);\r\n      }\r\n    } catch (error) {\r\n      setIsLoggedIn(false);\r\n    }\r\n  };\r\n\r\n  const checkAuthentication = () => {\r\n    if (authInfo.userInfo) {\r\n      setIsLoggedIn(authInfo.isLoggedIn);\r\n    } else {\r\n      getUserInfo();\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    // checkAuthentication();\r\n    if(authInfo.token && authInfo.token !=''){\r\n      setIsLoggedIn(true)\r\n    }\r\n  }, [authInfo.token]);\r\n\r\n  return (\r\n    <NavigationContainer>\r\n      {isLoggedIn ? <BottomTabNavigator /> : <AuthNavigator />} \r\n      \r\n      \r\n    </NavigationContainer>\r\n  );\r\n};\r\n\r\nexport default AppRoute;\r\n"],"mappings":";;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,mBAAT,QAAoC,0BAApC;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,YAAP,MAAyB,2CAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,SAAT;AAEA,SAAQC,YAAR;AACA,OAAOC,aAAP;AACA,OAAOC,kBAAP;;;AAEA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,GAAM;EACrB,IAAMC,QAAQ,GAAGN,WAAW,EAA5B;;EACA,sBAAoCL,KAAK,CAACY,QAAN,CAAe,KAAf,CAApC;EAAA;EAAA,IAAOC,UAAP;EAAA,IAAmBC,aAAnB;;EACA,IAAMC,QAAQ,GAAGb,WAAW,CAAC,UAACc,KAAD;IAAA,OAAWA,KAAK,CAACC,QAAjB;EAAA,CAAD,CAA5B;;EAEA,IAAMC,WAAW,GAAG;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,iCAGIf,YAAY,CAACgB,OAAb,CAAqB,OAArB,CAHJ;;UAAA;YAGVC,KAHU;;YAAA,MAKZA,KAAK,KAAK,IALE;cAAA;cAAA;YAAA;;YAAA;YAAA,iCAORhB,KAAK,CACRiB,GADG,CACC,UADD,EAEHC,IAFG,CAEE,iBAAOC,QAAP;cAAA;gBAAA;kBAAA;oBAAA;sBACJZ,QAAQ,CAACL,SAAS,CAACiB,QAAQ,CAACC,IAAV,CAAV,CAAR;sBACAV,aAAa,CAAC,IAAD,CAAb;;oBAFI;oBAAA;sBAAA;kBAAA;gBAAA;cAAA;YAAA,CAFF,EAMHW,KANG,CAMG,UAACC,KAAD,EAAW;cAChBC,OAAO,CAACC,GAAR,CAAYF,KAAZ;cACAZ,aAAa,CAAC,KAAD,CAAb;YACD,CATG,CAPQ;;UAAA;YAAA;YAAA;;UAAA;YAkBdA,aAAa,CAAC,KAAD,CAAb;;UAlBc;YAAA;YAAA;;UAAA;YAAA;YAAA;YAqBhBA,aAAa,CAAC,KAAD,CAAb;;UArBgB;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAApB;;EAyBA,IAAMe,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;IAChC,IAAId,QAAQ,CAACe,QAAb,EAAuB;MACrBhB,aAAa,CAACC,QAAQ,CAACF,UAAV,CAAb;IACD,CAFD,MAEO;MACLK,WAAW;IACZ;EACF,CAND;;EAQAlB,KAAK,CAAC+B,SAAN,CAAgB,YAAM;IAEpB,IAAGhB,QAAQ,CAACiB,KAAT,IAAkBjB,QAAQ,CAACiB,KAAT,IAAiB,EAAtC,EAAyC;MACvClB,aAAa,CAAC,IAAD,CAAb;IACD;EACF,CALD,EAKG,CAACC,QAAQ,CAACiB,KAAV,CALH;EAOA,OACE,KAAC,mBAAD;IAAA,UACGnB,UAAU,GAAG,KAAC,kBAAD,KAAH,GAA4B,KAAC,aAAD;EADzC,EADF;AAOD,CApDD;;AAsDA,eAAeH,QAAf"},"metadata":{},"sourceType":"module"}